{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/ufl/Downloads/sbitar/front/medilink-microfront/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpHeaders } from '@angular/common/http';\nimport { Urls } from '../config/Urls';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class UsersService {\n  constructor(http) {\n    this.http = http;\n    this.BASE_URL = Urls.Users;\n  }\n  getYourProfile(token) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const url = `${_this.BASE_URL}/adminuser/get-profile`;\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${token}`\n      });\n      try {\n        const response = yield _this.http.get(url, {\n          headers\n        }).toPromise();\n        // Store userId in localStorage for WebSocket subscription\n        if (response?.ourUsers?.id) {\n          localStorage.setItem('userId', response.ourUsers.id);\n        }\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    })();\n  }\n  // Fetch list of users for private chat selection\n  getAvailableUsers(token) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const url = `${_this2.BASE_URL}/users/list`; // Adjust endpoint as per backend\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${token}`\n      });\n      try {\n        const response = yield _this2.http.get(url, {\n          headers\n        }).toPromise();\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    })();\n  }\n  login(email, password) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      const url = `${_this3.BASE_URL}/auth/login`;\n      try {\n        const response = _this3.http.post(url, {\n          email,\n          password\n        }).toPromise();\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    })();\n  }\n  /*\n    async register(userData:any, token:string):Promise<any>{\n      const url = `${this.BASE_URL}/auth/register`;\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${token}`\n      })\n      try{\n        const response =  this.http.post<any>(url, userData, {headers}).toPromise()\n        return response;\n      }catch(error){\n        throw error;\n      }\n    }*/\n  register(userData) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      const url = `${_this4.BASE_URL}/auth/register`;\n      try {\n        const response = yield _this4.http.post(url, userData).toPromise();\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    })();\n  }\n  getAllUsers(token) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      const url = `${_this5.BASE_URL}/admin/get-all-users`;\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${token}`\n      });\n      try {\n        const response = _this5.http.get(url, {\n          headers\n        }).toPromise();\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    })();\n  }\n  getUsersById(userId, token) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      const url = `${_this6.BASE_URL}/admin/get-users/${userId}`;\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${token}`\n      });\n      try {\n        const response = _this6.http.get(url, {\n          headers\n        }).toPromise();\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    })();\n  }\n  getOwnUsersById(userId) {\n    var _this7 = this;\n    return _asyncToGenerator(function* () {\n      const url = `${_this7.BASE_URL}/get-users/${userId}`;\n      // Retrieve token internally if available\n      const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\n      // Define headers only if the token exists\n      const headers = token ? new HttpHeaders({\n        'Authorization': `Bearer ${token}`\n      }) : new HttpHeaders();\n      try {\n        const response = yield _this7.http.get(url, {\n          headers\n        }).toPromise();\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    })();\n  }\n  deleteUser(userId, token) {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      const url = `${_this8.BASE_URL}/admin/delete/${userId}`;\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${token}`\n      });\n      try {\n        const response = _this8.http.delete(url, {\n          headers\n        }).toPromise();\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    })();\n  }\n  updateUSer(userId, userData, token) {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      const url = `${_this9.BASE_URL}/admin/update/${userId}`;\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${token}`\n      });\n      try {\n        const response = _this9.http.put(url, userData, {\n          headers\n        }).toPromise();\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    })();\n  }\n  updateOwnUser(userId, userData) {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      const url = `${_this10.BASE_URL}/update/${userId}`;\n      try {\n        const response = yield _this10.http.put(url, userData).toPromise();\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    })();\n  }\n  logOut() {\n    if (typeof localStorage !== 'undefined') {\n      localStorage.removeItem('token');\n      localStorage.removeItem('role');\n    }\n  }\n  isAuthenticated() {\n    if (typeof localStorage !== 'undefined') {\n      const token = localStorage.getItem('token');\n      return !!token;\n    }\n    return false;\n  }\n  isAdmin() {\n    if (typeof localStorage !== 'undefined') {\n      const role = localStorage.getItem('role');\n      return role === 'ADMIN';\n    }\n    return false;\n  }\n  isUser() {\n    if (typeof localStorage !== 'undefined') {\n      const role = localStorage.getItem('role');\n      return role === 'USER';\n    }\n    return false;\n  }\n  static {\n    this.ɵfac = function UsersService_Factory(t) {\n      return new (t || UsersService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: UsersService,\n      factory: UsersService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["HttpHeaders","Urls","UsersService","constructor","http","BASE_URL","Users","getYourProfile","token","_this","_asyncToGenerator","url","headers","response","get","toPromise","ourUsers","id","localStorage","setItem","error","getAvailableUsers","_this2","login","email","password","_this3","post","register","userData","_this4","getAllUsers","_this5","getUsersById","userId","_this6","getOwnUsersById","_this7","window","getItem","deleteUser","_this8","delete","updateUSer","_this9","put","updateOwnUser","_this10","logOut","removeItem","isAuthenticated","isAdmin","role","isUser","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\ufl\\Downloads\\sbitar\\front\\medilink-microfront\\src\\app\\Services\\users.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Urls } from '../config/Urls';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UsersService {\n\n  private BASE_URL = Urls.Users;\n\n  constructor(private http: HttpClient) { }\n\n\n\n\n  async getYourProfile(token: string): Promise<any> {\n    const url = `${this.BASE_URL}/adminuser/get-profile`;\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${token}`\n    });\n    try {\n      const response = await this.http.get<any>(url, { headers }).toPromise();\n      // Store userId in localStorage for WebSocket subscription\n      if (response?.ourUsers?.id) {\n        localStorage.setItem('userId', response.ourUsers.id);\n      }\n      return response;\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  // Fetch list of users for private chat selection\n  async getAvailableUsers(token: string): Promise<any> {\n    const url = `${this.BASE_URL}/users/list`; // Adjust endpoint as per backend\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${token}`\n    });\n    try {\n      const response = await this.http.get<any>(url, { headers }).toPromise();\n      return response;\n    } catch (error) {\n      throw error;\n    }\n  }\n  async login(email:string, password:string):Promise<any>{\n    const url = `${this.BASE_URL}/auth/login`;\n    try{\n      const response =  this.http.post<any>(url, {email, password}).toPromise()\n      return response;\n\n    }catch(error){\n      throw error;\n    }\n  }\n/*\n  async register(userData:any, token:string):Promise<any>{\n    const url = `${this.BASE_URL}/auth/register`;\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${token}`\n    })\n    try{\n      const response =  this.http.post<any>(url, userData, {headers}).toPromise()\n      return response;\n    }catch(error){\n      throw error;\n    }\n  }*/\n    async register(userData: any): Promise<any> {\n      const url = `${this.BASE_URL}/auth/register`;\n    \n      try {\n        const response = await this.http.post<any>(url, userData).toPromise();\n        return response;\n      } catch (error) {\n        throw error;\n      }\n    }\n    \n\n  async getAllUsers(token:string):Promise<any>{\n    const url = `${this.BASE_URL}/admin/get-all-users`;\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${token}`\n    })\n    try{\n      const response =  this.http.get<any>(url, {headers}).toPromise()\n      return response;\n    }catch(error){\n      throw error;\n    }\n  }\n\n\n\n  async getUsersById(userId: string, token:string):Promise<any>{\n    const url = `${this.BASE_URL}/admin/get-users/${userId}`;\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${token}`\n    })\n    try{\n      const response =  this.http.get<any>(url, {headers}).toPromise()\n      return response;\n    }catch(error){\n      throw error;\n    }\n  }\n\n  async getOwnUsersById(userId: string): Promise<any> {\n    const url = `${this.BASE_URL}/get-users/${userId}`;\n  \n    // Retrieve token internally if available\n    const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\n  \n    // Define headers only if the token exists\n    const headers = token\n      ? new HttpHeaders({ 'Authorization': `Bearer ${token}` })\n      : new HttpHeaders();\n  \n    try {\n      const response = await this.http.get<any>(url, { headers }).toPromise();\n      return response;\n    } catch (error) {\n      throw error;\n    }\n  }\n  \n  async deleteUser(userId: string, token:string):Promise<any>{\n    const url = `${this.BASE_URL}/admin/delete/${userId}`;\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${token}`\n    })\n    try{\n      const response =  this.http.delete<any>(url, {headers}).toPromise()\n      return response;\n    }catch(error){\n      throw error;\n    }\n  }\n\n  async updateUSer(userId: string, userData: any, token:string):Promise<any>{\n    const url = `${this.BASE_URL}/admin/update/${userId}`;\n    const headers = new HttpHeaders({\n      'Authorization': `Bearer ${token}`\n    })\n    try{\n      const response =  this.http.put<any>(url, userData, {headers}).toPromise()\n      return response;\n    }catch(error){\n      throw error;\n    }\n  }\n  \n\n  async updateOwnUser(userId: string, userData: any): Promise<any> {\n    const url = `${this.BASE_URL}/update/${userId}`;\n  \n    try {\n      const response = await this.http.put<any>(url, userData).toPromise();\n      return response;\n    } catch (error) {\n      throw error;\n    }\n  }\n  \n  logOut():void{\n    if(typeof localStorage !== 'undefined'){\n      localStorage.removeItem('token')\n      localStorage.removeItem('role')\n    }\n  }\n\n  isAuthenticated(): boolean {\n    if(typeof localStorage !== 'undefined'){\n      const token = localStorage.getItem('token');\n      return !!token;\n    }\n    return false;\n\n  }\n\n  isAdmin(): boolean {\n    if(typeof localStorage !== 'undefined'){\n      const role = localStorage.getItem('role');\n      return role === 'ADMIN'\n    }\n    return false;\n\n  }\n\n  isUser(): boolean {\n    if(typeof localStorage !== 'undefined'){\n      const role = localStorage.getItem('role');\n      return role === 'USER'\n    }\n    return false;\n\n  }\n\n\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}